# Events и stores по простому

## Прежде, чем мы начнем

Парочка ссылок, по которым стоит пройтись для лучшего понимания раздела. Это ссылочки на доку эффектора и/или патронума.

1) [Events](https://effector.dev/docs/api/effector/event)
2) [Stores](https://effector.dev/docs/api/effector/store)
3) [Patronum](https://github.com/effector/patronum)

Начнем наше погружение с маленького компонента.
Обычно, такую логику не стоит выносить в стейт менеджеры, но для целей обучения, это будет не плохой старт.

### Задачи:

1) Создать компонент со звездочками.
2) Звезды должны менять свой цвет при наведении.
3) Звезды должны менять цвет при выборе рейтинга.

### Первый шаг

1) Создаем стор при помощи [createStore](https://effector.dev/docs/api/effector/createStore) для hoveredRating и задаем
   стартовое значение равное 0.
2) Согласно документации название стора должно содержать знак доллара $ в начале. Это общепринятый стандарт в среде
   эффектора.
3) Так же мы можем добавить тип для нашего стора.
4) Так же я добавил в конфиг стора поле name, чтобы было легче дебажить в дальнейшем. Для дебага удобно испоользовать
   библиотеку [Patronum](https://github.com/effector/patronum), она упрощает дебаг для сторов/евентов и т.д.

```ts
export const $hover = createStore<number>(0, {
    name: 'hover'
})
```

### Второй шаг

Настало время создать евент при помощи  [createEvent](https://effector.dev/docs/api/effector/createEvent).   
Проще говоря, евент это функция которая может в себя принимать аргументы, по дефолту принимает void. Евенты выступают
триггерами для запуска цепи событий (действий).
Тайпскрипт помогает не запутаться, нужен ли нам пейлоад при вызове евента или нет. Я указал пейлоад евент как число.
И теперь, когда я буду использовать свой евент, он всегда будет ожидать, что этот евент принимает в себя число.

```ts
export const setHoveredRating = createEvent<number>()
```

### Третий шаг

А сейчас время для магии - соединим наш евент и стор.
Давайте по шагам разберемся, как это работает.

```ts
$hover.on(setHoveredRating, (_, rating) => rating)
```

1) Соединяем наш $hover (стор) с setHoveredRating (евент). Когда мы вызоем наш евент, тогда наш стор обновится.
2) Передаем коллбек вторым аргументом в .on метод.

Этот колбек принимает два аргумента - значение стора и пейлод евента. Если нам не нужны данные со стора, принято называть первый аргумент андексором ('_')
Когда мы вызываем setHoveredRating с пейлоадом, наш стор обновится. Вы можете писать любую логику взаимодействия с данным, но помните этот колбек должен быть ЧИСТО ФУНКЦИЕЙ.

**Обязательно знать**

1) Если вызвать евент с тем же самым значением, что уже лежит в сторе (``if oldState === payload from event``), стор НЕ обновится.
2) Если отправить undefined в сторе, стор так же НЕ обновится.

#### Парочка советов с библиотекой [Patronum](https://github.com/effector/patronum)

Если заглянете в  model.ts , то найдете функцию debug со сторами и евентами. Откройте консоль и измените рейтинг,  и посмотрите что будет в консоле.
Гораздо удобней использовать [debug](https://github.com/effector/patronum/tree/main/src/debug) from patronum, чем самому дебажить код.

### Что мы сделали в этом уроке?

1) Создали стор
2) Создали евент
3) Подписались в сторе на изменения евента.

### Поздравляю! Теперь можете запустить проект и посмотреть, что получилось!

Не ругайте меня за css, >_<


